<!DOCTYPE html>
<html>
<style>
body {
	 background-color: #ffffff;
}
 body * {
	 box-sizing: border-box;
}
 .header {
	 background-color: #327a81;
	 color: white;
	 font-size: 1.5em;
	 padding: 1rem;
	 text-align: center;
	 text-transform: uppercase;
}
 img {
	 border-radius: 50%;
	 height: 60px;
	 width: 60px;
}
 .table-users {
	 border: 1px solid #84F079;
	 border-radius: 10px;
	 box-shadow: 3px 3px 0 rgba(0, 0, 0, 0.1);
	 max-width: calc(100% - 2em);
	 margin: 1em auto;
	 overflow: hidden;
	 width: 800px;
}
 table {
	 width: 100%;
}
 table td, table th {
	 color: #131212;
	 padding: 10px;
}
 table td {
	 text-align: center;
	 vertical-align: middle;
}
 table td:last-child {
	 font-size: 0.95em;
	 line-height: 1.4;
	 text-align: left;
}
 table th {
	 background-color: #b9ee96;
	 font-weight: 300;
}
 table tr:nth-child(2n) {
	 background-color: rgb(255, 255, 255);
}
 table tr:nth-child(2n+1) {
	 background-color: #edf7f8;
}

table td, table th  {
    border: 0.5px solid powderblue;
}
 

.dropbtn {
  background-color: #ffffff;
  color: rgb(73, 69, 69);
  padding: 16px;
  font-size: 16px;
  border: none;
  cursor: pointer;
}

.dropdown {
  position: relative;
  display: inline-block;
}

.dropdown-content {
  display: none;
  position: absolute;
  background-color: #f9f9f9;
  min-width: 160px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
  z-index: 1;
}

.dropdown-content a {
  color: black;
  padding: 12px 16px;
  text-decoration: none;
  display: block;
}

.dropdown-content a:hover {background-color: #f1f1f1}

.dropdown:hover .dropdown-content {
  display: block;
}

.dropdown:hover .dropbtn {
  background-color: #ffffff;
}

 
 
</style>

<body onload="showData()" >
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  <nav class="navbar navbar-default">
    <div class="container-fluid" style="background-color: rgb(255, 255, 255);">
      <div class="navbar-header">
        <a class="navbar-brand" href="#">Purchasing</a>
      </div>
      <!-- <ul class="nav navbar-nav">
        <li ><a href="/main">Home</a></li>
        <li><a href="/user">user</a></li>
        <li><a href="/admin">admin</a></li>
        <li><a href="/">Page 3</a></li>
      </ul> -->
      <ul class="nav navbar-nav navbar-right">
        <li>
          <div class="dropdown">
             <button class="dropbtn">Setting
             <i class="fa fa-caret-down"></i>
             </button>
             <div class="dropdown-content">
             <a href="/useredit">ดูข้อมูลสมาชิก</a>
             <a href="/shopedit">ดูข้อมูลร้านค้า</a>
             <!-- <a href="#">Link 3</a> -->
             </div>
           </div>
           </li>
        <li><a href="/"><span class="glyphicon glyphicon-log-in"></span> Logout</a></li>
        </ul>
    </div>
    
  </nav>
  
  <div id="Home" class="tabcontent"style="margin: 40px;">
    <!-- <h3>Home</h3> -->
    <div>
        <form style="text-align:  center; margin: 40px;" >
          <label > รหัสการชื้อ </label>&nbsp;&nbsp;<input readonly id="codeForBuy" type="text" >
             
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <label> ชื่องบประมาณ </label>&nbsp;&nbsp; <input  readonly id="nameproject" type="text">
            
          &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
          <label>ราคารวมทั้งหมดของทุกชิ้น </label> &nbsp;&nbsp;<input readonly id="amountAll" type="text">
    
          <!--<button >ค้นหา</button>-->
        </form>
        <br>
    
    
        <!-- <div class="header">Users</div> -->
        
        <table cellspacing="0">
           <tr>
              <td>ลำดับ </td>
              <td>ชื่อวัสดุ</td>
              <td>Part Number</td>
              <td>ราคา(เสนอ)</td>
              <td>จำนวน(เสนอ)</td>
              <td>ราคา(แก้ไข)</td>
              <td>จำนวน(แก้ไข)</td>
              <td>ราคารวม(เสนอ)</td>
              <td>ราคารวม(แก้ไข)</td>
              <td>ผู้รับผิดชอบ</td>
              <td>รูป</td>
              <td width="230">สถานะ</td>
              <td>ร้านค้า</td>
              <!-- <td>แก้ไข</td>
              <td>ลบ</td> -->
              <tbody id="room-namedata"></tbody>
           </tr>
     
           <!-- <tr>
              <td>1</td>
              <td><a href="/">NewNewNew</a></td>
              <td>jane.doe@foo.com</td>
              <td><input name="first" type="text"></td>
              <td>Lorem ipsum dolor sit amet, consectetur adipisicing elit. </td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>01 800 2000</td>
              <td>
                <input type="button" id="button" value = "สถานะ" style= "color:rgb(0, 0, 0)" onclick="setColor('button', '#000000')";/>
               -->
        </table>
     </div>
     <button type="button" style="float: right; margin: 12.5px;" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalforadddata" >เพิ่มข้อมูลสินค้า</button>
     <button style="float: right; margin: 10px;" type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#ModalForAddShop">เพิ่มข้อมูลร้านค้า</button>
    
      <!-- Modal -->
      <div class="modal fade" id="myModalforadddata" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">เพิ่มสินค้า</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อวัสดุ</label>
                <input  id="item" name="item" type="text"><br>
                <br>
                <label>Part Number</label>
                <input id="partnumber" name="partnumber" type="text"><br> 
                <br>
                <label>ราคา</label>
                <input  id="price" name="price" type="number"><br>
                <br>
                <label>จำนวน</label>
                <input  id="amountz" name="amount" type="number"><br>
                <br>
                <label>ราคารวม</label>
                <input  id="sumprice" name="sumprice" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  id="responsibleperson" name="responsibleperson" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  id="statusz" type="text"><br>
                <label>ร้านค้าของท่าน</label>
                <select
                    class="custom-select storage"
                    id="storage"
                    required
                  ></select>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalforadddata" onclick="addDataAdmin()">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>


  <div class="modal fade" id="ModalForAddShop" role="dialog">
    <div class="modal-dialog">
    
      <!-- Modal content-->
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal">&times;</button>
          <h4 class="modal-title">แก้ไขข้อมูล</h4>
        </div>
        <div class="modal-body">
          <form>
            <label>ชื่อร้านค้า</label>
            <input name="nameshop" type="text" id="nameshop"><br>
            <br>
            <label for="typeshop">ประเภทร้านค้า</label>
            <select name="typeshopp" id="typeshoppp">
              <option value="1">ในประเทศ</option>
              <option value="2">ต่างประเทศ</option>
            </select>
            <br>
            <label>ภาษีร้านค้า</label>
            <input name="taxshop" type="float" id="taxshop"><br>  
            <br>
            <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#ModalForAddShop" onclick="addShop()">เพิ่มข้อมูล</button>
            <input class="btn btn-info btn-lg" type="reset" value="Reset">
            </form>    
        </div>
        <div class="modal-footer">
          
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        </div>
      </div>
      
    </div>
  </div>

  
  
  

    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>

                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>
  
  
    
    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form>
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>

                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
        </div>
      </div>
  </div>
  
  

    
      <!-- Modal -->
      <div class="modal fade" id="myModal" role="dialog">
        <div class="modal-dialog">
        
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal">&times;</button>
              <h4 class="modal-title">Modal Header</h4>
            </div>
            <div class="modal-body">
              <form id="headerTable">
                <label>ชื่อร้าน</label>
                <input name="first" type="text"><br>
                <br>
                <label>ชื่อวัสดุ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>Part Number</label>
                <input name="first" type="text"><br>  
                <br>
                <label>ราคา</label>
                <input  name="last" type="text"><br>
                <br>
                <label>จำนวน</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ราคารวม</label>
                <input  name="last" type="text"><br>
                <br>
                <label>ผู้รับผิดชอบ</label>
                <input  name="last" type="text"><br>
                <br>
                <label>สถานะ</label>
                <input  name="last" type="text"><br>
                <div class="form-group">
                    <label for="img">รูป:</label>
                    <input type="file" id="img" name="img" accept="image/*">
                </div>
                <br>
                <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModal">เพิ่มข้อมูล</button>
                <input class="btn btn-info btn-lg" type="reset" value="Reset">
                </form>    
            </div>
            <div class="modal-footer">
              
              <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>
          </div>
          
          
        </div>
      </div>
  </div>

   <div id="shopNameTab"><button style="margin-left: 40px;" type="button" class="btn btn-light" onclick="showAllData()">DataAll</button>&nbsp;</div>
  <!-- <br>
  <button class="tablink" onclick="openPage('Home', this, 'red')" id="defaultOpen">ร้านแรก</button>
  <button class="tablink" onclick="openPage('News', this, 'green')" >ร้านสอง</button>
  <button class="tablink" onclick="openPage('Contact', this, 'blue')">ร้านสาม</button>
  <button class="tablink" onclick="openPage('About', this, 'orange')">ร้านสี่</button>
<br> -->
<br>
        สถานะการจัดชื้อ:
        <select id="statusadmin"  >
            <option>รออนุมัติ / อนุมัติ /ตรวจรับแล้ว/ รอส่งของ </option>
            <option value="รออนุมัติ">รออนุมัติ</option>
            <option value="อนุมัติ">อนุมัติ</option>
            <option value="ตรวจรับแล้ว">ตรวจรับแล้ว</option>
            <option value="รอส่งของ">รอส่งของ</option>
          </select>
          <br>
          <br>
          <br>
        หมายเหตุ:  
        <textarea id="reasonadmin" name="w3review" rows="4" cols="50">
            
        </textarea>

        <iframe id="txtArea1" style="display:none"></iframe>
            <br><br>
            <input  onclick="goToTable()" type="submit" value="บันทึก">

            <button class="btn btn-info" onclick="Export()">export &nbsp;</button>
        
  
        <!--<button >ค้นหา</button>-->
    
  <!-- Modal for Edit-->
  <div class="modal fade" id="myModalForEditDataAdmin" role="dialog" >
    <!-- <div class="modal fade" id="Modalzz" role="dialog" onload="profile()"> -->
      <div class="modal-dialog"  >
      
        <!-- Modal content-->
        <div class="modal-content" >
          <div class="modal-header" >
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Modal EDIT</h4>
          </div>
          <div class="modal-body"  id="Modal-c">
        
            <form>
        <input class="btn btn-info btn-lg" type="reset" value="Reset">
        <!-- <div id="Modal-a"></div> -->
        
        
              </form>
              <!-- <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#Modalzz">Update</button> -->
          </div>
          <div class="modal-footer">
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalForEditDataAdmin" onclick="addEdit()">UpdateData</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
        
      </div>
    </div>
    

     <!-- Modal for Edit-->
  <div class="modal fade" id="modalforeditshop" role="dialog" >
    <!-- <div class="modal fade" id="Modalzz" role="dialog" onload="profile()"> -->
      <div class="modal-dialog"  >
      
        <!-- Modal content-->
        <div class="modal-content" >
          <div class="modal-header" >
            <button type="button" class="close" data-dismiss="modal">&times;</button>
            <h4 class="modal-title">Modal EDIT</h4>
          </div>
          <div class="modal-body"  id="Modal-D">
        
            <form>
        <input class="btn btn-info btn-lg" type="reset" value="Reset">
        <!-- <div id="Modal-a"></div> -->
        
        
              </form>
              <!-- <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#Modalzz">Update</button> -->
          </div>
          <div class="modal-footer">
        <button type="button" class="btn btn-info btn-lg" data-toggle="modal" data-target="#myModalForEditDataAdmin" onclick="addEdit()">UpdateData</button>
            <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          </div>
        </div>
        
      </div>
    </div>
   

</body>
</html>

<script>

function showshop(val) {

console.log("DDDDDDDD---->>   "+ val)
//console.log("PEEGALE:"+ data[i].nameOfShop)
var valueid = document.getElementById("forshop"+val).value;

console.log("มาแล้วสัส   -----"+ valueid,getValueLocalStorage) // ส่งไป >> ได้ ได้

//กรีด เดะวันนี้ไปชื้อบราวนี้ให้เลย มึงถามเขาก่อนส่งมาจะบูดไหม 55555 ช๊อต

    $.post("/get/showshopnameintableinadminaccess",{ '_ID': valueid ,'_MAINID': getValueLocalStorage }, function (data, status) {
    document.getElementById("room-namedata").innerHTML="";
    console.log("sadsadegeg ---->>>"+data.length)
    for (let i = 0; i < data.length; i++) {

    str = data[i]._id.replace(/\s/g, '');
    console.log(str);
    roomId = data;
   // let rstripId = data[i]._id.rs
    //$("#room-name-value").val(data[0].room);
     $("#room-namedata").append(
    "<tr><td>" +
      (i + 1) +
      "</td>" +
      "<td id='order"+i+"'>" +
        ShowShopName[data[i].shopid] +
        //  ShowShopName[data[i].shopid] +
      "</td>" +
      "<td >" +
     data[i].item +
        //  ShowShopName[data[i].shopid] +
      "</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>"+
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].item +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  ShowShopName[data[i].shopid] +
        //  ShowShopName[data[i].shopid] +
"</td>" +
"<td >" +
  data[i].mainid +
        //  ShowShopName[data[i].shopid] +
"</td>" 



  );
}

});

}


var ShowShopName = {};

$(document).ready(function(){
    $.post('/get/shop', function(data, status)
    {
      ShopName = data;
        for(let i=0; i<ShopName.length; i++)
        {
            // console.log([data[i]]); 
            let objId = ShopName[i]._id;

            ShowShopName[objId] = ShopName[i].nameOfShop;

            //let nameCategory = categoryName[i].equip_category;

        }
    });
});
  

    function goToTable() {
    console.log("บันทึกข้อมูล");
    //console.log(getValueLocalStorage);
	  {    
		if (confirm("คุณต้องการบันทึกข้อมูลใช่หรือไม่")) {
      //var shop = $("#shop").val();
      var reason = $("#reasonadmin").val();
      var status = $("#statusadmin").val();
      console.log(status,reason);
		  //var group = $("#group").val();
		  //var department = $("#department").val();
      console.log(getValueLocalStorage);
      $.post(
			"/api/addmaintableadmin",
			{
        //shop: shop,
        LetServerGetDataOrderFromMainTable: getValueLocalStorage,
        status: status,
        reason: reason,
        //picture: req.body.picture,
        //reason:  req.body.reason,
			  //group: status,
			  //department: department,
			},
			function (data, status) {
			  window.location.href = "/main";
			  
			}
		  );
		 } 
	  } 
  }

  

  </script>

<script>
    function openPage(pageName,elmnt,color) {
      var i, tabcontent, tablinks;
      tabcontent = document.getElementsByClassName("tabcontent");
      for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
      }
      tablinks = document.getElementsByClassName("tablink");
      for (i = 0; i < tablinks.length; i++) {
        tablinks[i].style.backgroundColor = "";
      }
      document.getElementById(pageName).style.display = "block";
      elmnt.style.backgroundColor = color;
    }
    
    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
    </script>

<script>

    var count = 1;
    function setColor(btn, color) {
        var property = document.getElementById(btn);
        if (count == 0) {
            property.style.backgroundColor = "#FF0000"
            count = 2;        
        }
        else if(count == 2){
            property.style.backgroundColor = "#00FF00"
            count = 3;
        }
        else{
            property.style.backgroundColor = "#0000FF"
            count = 0;
        }
    }

</script>
<script>
function Export(){
  var csv = [];
  var rows = document.querySelectorAll("table tr");
  // console.log(rows);
    for (var i = 0; i < rows.length; i++) 
    {
      var row = [], cols = rows[i].querySelectorAll("td, th");
      
          for (var j = 0; j < cols.length-1; j++)
          {
            row.push(cols[j].innerText);
          } 
      csv.push(row.join(","));    
    }
    // console.log(csv);
    // Download CSV
    download_csv(csv.join("\n"), "export.csv");
}
function download_csv(csv, filename) {
  var csvFile;
  var downloadLink;

  // CSV FILE
  csvFile = new Blob([
            new Uint8Array([0xEF, 0xBB, 0xBF]), // UTF-8 BOM
            csv
            ],
            { type: "text/csv;charset=utf-8" });

  // Download link
  downloadLink = document.createElement("a");

  // File name
  downloadLink.download = filename;

  // We have to create a link to the file
  downloadLink.href = window.URL.createObjectURL(csvFile);

  // Make sure that the link is not displayed
  downloadLink.style.display = "none";

  // Add the link to your DOM
  document.body.appendChild(downloadLink);

  // Lanzamos
  downloadLink.click();
}




function showAllData() {

  location.reload();

  // $.post("/get/dataForSearchTableMainIdAdmin2" ,{_ID: getValueLocalStorage},function (data, status) {
  //   //document.getElementById("room-namedata").innerHTML="";
  //     //console.log('Daaawww'+getValueLocalStorage);
  //     var sum = 0 ;
	// 	//document.getElementById("room-name").innerHTML="";
  //     for (let i = 0; i < data.length; i++) {
  //      // data[i].sumpriceadmin = 0;
  //      console.log("NEWNEWNEWNEWNEWNEWNEWN"+data.length);
  //        //data[i].sumpriceadmin = data[i].priceadmin * data[i].amountadmin;
  //       //  data[i].sumprice = data[i].price * data[i].amount;
  //        //data[i].sumprice = "";
  //       // data[i].sumpriceadmin = "";
  //     //   sum += parseInt(data[i].sumpriceadmin);
       

  //     //  console.log("Sum = "+ sum);   
	// 	  //console.log(data[i]._id);
	// 	  str = data[i]._id.replace(/\s/g, '');
	// 	  console.log("newienqwpdjqwidjmqowidjqwdij --->>>>>>>>"+str);
  //       roomId = data;
	// 	// let rstripId = data[i]._id.rs
  //       //$("#room-name-value").val(data[0].room);
  //       $("#room-namedata").append(
	// 	  "<tr><td>" +
  //           (i + 1) +
  //           "</td>" +
	// 		"<td>" +
  //           data[i].item +
	// 		"</td>" +
	// 		"<td>" +
  //           data[i].partnumber +
	// 		"</td>" +
	// 		"<td>" +
  //           data[i].price +
	// 		"</td>" +
	// 		"<td>" +
  //           data[i].amount +
  //     "</td>" +
  //     "<td>" +
  //           data[i].priceadmin +
	// 		"</td>" +
	// 		"<td>" +
  //           data[i].amountadmin +
  //     "</td>" +
  //     "<td>" +
  //           data[i].sumprice +
  //     "</td>" +
  //     "<td>" +
  //           data[i].sumpriceadmin +
  //     "</td>" +
  //     "<td>" +
  //           data[i].responsibleperson +
  //     "</td>" +
  //     "<td>" +
  //           data[i].statusz +
  //     "</td>" +
  //     "<td>" +
  //           ShowShopName[data[i].shopid] +
  //     "</td>" +
  //     "<td>" +
  //           [data[i].mainid] +
  //     "</td>" +
	// 		// "<td>" +
	// 		// <a data-toggle="modal" data-target="#Modalzz">แก้ไข</a> +
	// 		// "</td>" +
	// 		 "<td><a data-toggle='modal' data-target='#myModalForEditDataAdmin' class='btn btn-info'  onclick='editData('"+i+"')' >แก้ไข</a>" +
	// 			//"<td><a data-toggle='modal' data-target='#Modalzz' data-target='#exampleModal02' onclick='save()' >แก้ไข</a>" +
  //           "<div class='modal fade' id='exampleModal02' tabindex='-1' role='dialog' aria-labelledby='exampleModal02Label' aria-hidden='true' data-backdrop='static' data-keyboard='false'>" +
  //           "<div class='modal-dialog modal-dialog-centered'>" +
  //           "<div class='modal-content'>" +
  //           "<div class='modal-header'>" +
  //           "<h5 class='modal-title'  id='exampleModal02Label'>แก้ไข</h5>" +
  //           "<button type='button' class='close' data-dismiss='modal' aria-label='Close'>" +
  //           "<span aria-hidden='true'>&times;</span>" +
  //           "</button>" +
  //           "</div>" +
  //           "<div class='modal-footer'>" +
  //           "<button type='button' class='btn btn-secondary' data-dismiss='modal'>ยกเลิก</button>" +
  //           "</div>" +
  //           "</div></td>" +
  //           "<td><button href='#' class='btn btn-danger' onclick=DeleteDataAdmin('"+str.toString()+"') >ลบ</button></td>" +
	// 		"</tr>"
			

  //       );  
  //     }
      
  //   }); 

}

function showData() {

  $.post("/get/maintable", function (data, status) {
      console.log(data);
		//document.getElementById("room-name").innerHTML="";
      for (let i = 0; i < data.length; i++) {
		  //console.log(data[i]._id);
		  str = data[i]._id.replace(/\s/g, '');
		  console.log(str);
        roomId = data;
		// let rstripId = data[i]._id.rs
        //$("#room-name-value").val(data[0].room);
          $("#codeForBuy").val(getValueLocalStorage);
          $("#nameproject").val(getValueLocalStorageNameOrder);
          $("#amountAll").val(getValueLocalStorageAmount);
        
      }   
    }); 

    $.post("/get/shopforadd", function (data, status) {
      let roomData = data;
      for (let i = 0; i < roomData.length; i++) {
        let roomName = roomData[i].nameOfShop;
        console.log("dadadadadadad--->>>>>???? "+roomData[i]._id)
        $(".storage").append(
          "<option value=" + roomData[i]._id + ">" + roomName + "</option>"
        );
      }
              });
    
    $.post("/get/data",function (data, status) {

      console.log("newnewnewnewnewnenwenwnen"+data);
      var sum = 0 ;
		//document.getElementById("room-name").innerHTML="";
      for (let i = 0; i < data.length; i++) {
        data[i].sumpriceadmin = data[i].priceadmin * data[i].amountadmin;
        data[i].sumprice = data[i].price * data[i].amount;
        sum += parseInt(data[i].sumpriceadmin);
		  //console.log(data[i]._id);
		  str = data[i]._id.replace(/\s/g, '');
		  console.log(str);
        roomId = data;
		// let rstripId = data[i]._id.rs
        //$("#room-name-value").val(data[0].room);
          
          //$("#amountAll").val(sum);
        
      }   
    }); 

    

  $.post("/get/dataForSearchTableMainIdAdmin", {_ID: getValueLocalStorage},function (data, status) {
    //document.getElementById("room-name").innerHTML="";
      console.log('Daaawww'+getValueLocalStorage);
      var sum = 0 ;
		//document.getElementById("room-name").innerHTML="";
      for (let i = 0; i < data.length; i++) {
       // data[i].sumpriceadmin = 0;
       
         //data[i].sumpriceadmin = data[i].priceadmin * data[i].amountadmin;
        //  data[i].sumprice = data[i].price * data[i].amount;
         //data[i].sumprice = "";
        // data[i].sumpriceadmin = "";
      //   sum += parseInt(data[i].sumpriceadmin);
       

      //  console.log("Sum = "+ sum);   
		  //console.log(data[i]._id);
		  str = data[i]._id.replace(/\s/g, '');
		  console.log(str);
        roomId = data;
		// let rstripId = data[i]._id.rs
        //$("#room-name-value").val(data[0].room);
        $("#room-namedata").append(
		  "<tr><td>" +
            (i + 1) +
            "</td>" +
			"<td>" +
            data[i].item +
			"</td>" +
			"<td>" +
            data[i].partnumber +
			"</td>" +
			"<td>" +
            data[i].price +
			"</td>" +
			"<td>" +
            data[i].amount +
      "</td>" +
      "<td>" +
            data[i].priceadmin +
			"</td>" +
			"<td>" +
            data[i].amountadmin +
      "</td>" +
      "<td>" +
            data[i].sumprice +
      "</td>" +
      "<td>" +
            data[i].sumpriceadmin +
      "</td>" +
      "<td>" +
            data[i].responsibleperson +
      "</td>" +
      "<td>" +
            data[i].statusz +
      "</td>" +
      "<td>" +
            ShowShopName[data[i].shopid] +
      "</td>" +
      "<td>" +
            [data[i].mainid] +
      "</td>" +
			// "<td>" +
			// <a data-toggle="modal" data-target="#Modalzz">แก้ไข</a> +
			// "</td>" +
			//  "<td><a data-toggle='modal' data-target='#myModalForEditDataAdmin' class='btn btn-info'  onclick='editData("+i+")' >แก้ไข</a>" +
				//"<td><a data-toggle='modal' data-target='#Modalzz' data-target='#exampleModal02' onclick='save()' >แก้ไข</a>" +
            "<div class='modal fade' id='exampleModal02' tabindex='-1' role='dialog' aria-labelledby='exampleModal02Label' aria-hidden='true' data-backdrop='static' data-keyboard='false'>" +
            "<div class='modal-dialog modal-dialog-centered'>" +
            "<div class='modal-content'>" +
            "<div class='modal-header'>" +
            "<h5 class='modal-title'  id='exampleModal02Label'>แก้ไข</h5>" +
            "<button type='button' class='close' data-dismiss='modal' aria-label='Close'>" +
            "<span aria-hidden='true'>&times;</span>" +
            "</button>" +
            "</div>" +
            "<div class='modal-footer'>" +
            "<button type='button' class='btn btn-secondary' data-dismiss='modal'>ยกเลิก</button>" +
            "</div>" +
            "</div></td>" +
            // "<td><button href='#' class='btn btn-danger' onclick=DeleteDataAdmin('"+str.toString()+"') >ลบ</button></td>" +
			"</tr>"
			

        );  
      }
      
    }); 

    $.post("/get/shop", function (data, status) {

    //document.getElementById("room-namezz").innerHTML="";
    for (let i = 0; i < data.length; i++) {
    //console.log(data[i]._id);
    str = data[i]._id.replace(/\s/g, '');
    console.log(str);
    roomId = data;
    // let rstripId = data[i]._id.rs
    //$("#room-name-value").val(data[0].room);
      $("#shopNameTab").append(
    // "<tr><td>" +
    //       (i + 1) +
    //       "</td>" +
      //  "<td>"+ "<button class='tablink' onclick='"+openPage+"('"+data[i].nameOfShop+"'',"+this+", 'red')' id='order"+i+"'>" + data[i].nameOfShop +"</button>" + "</td>" 
      // "<td><button href='#' onclick=openPage('"+data[i].nameOfShop+"')  >name</button></td>" 
      // "<button></button>" 
      '&nbsp;'+
       "<button type='button' data-target='modalforeditshop' class='btn btn-light'    value='" + data[i]._id +"' id='forshop" + i + "' onclick='showshop("+ i +")'  ondblclick='Editshop("+ i +")' >" + data[i].nameOfShop +"</button>" 
      //  "<button data-target='modalforeditshop' ondblclick='Editshop("+ i +")'>" + "DDDDD" + "</button>" 
        // "<button type='button' class='btn btn-primary' >" + "Dan" +"</button>"
       
       
       
       
        // +"<input type='hidden' id='idshop"+i+"' value='" + data[i]._id +"'></input>"
      // ใช่ปะ ไรนะ ได้ ๆ  เยส      งานไม่ทำละเหรอพี่55555      



  );
}

});

  }

  function addDataAdmin() {
		console.log("asdasd");
	  {
      
		if (confirm("ต้องการเพิ่มผู้ใช้หรือไม่")) {
      //var shop = $("#shop").val();
      var codeForBuy = $("#codeForBuy").val();
		  var item = $("#item").val();
		  var partnumber = $("#partnumber").val();
		  var price = $("#price").val();
      var amount = $("#amountz").val();
      var priceadmin =  "";
      var amountadmin =  "";
      var sumprice = $("#sumprice").val();
      var sumpriceadmin =  "";
      var responsibleperson = $("#responsibleperson").val();
      var statusz = $("#statusz").val();
      var storage = $("#storage").val();
      console.log(codeForBuy);
		  //var group = $("#group").val();
		  //var department = $("#department").val();
  
		  $.post(
			"/api/adddata",
			{
			  //shop: shop,
			  item: item,
			  partnumber: partnumber,
        price: price,
        amount: amount,
        priceadmin: priceadmin,
        amountadmin: amountadmin,
        sumprice: sumprice,
        sumpriceadmin: sumpriceadmin,
        responsibleperson: responsibleperson,
        statusz: statusz,
        storage: storage,
        mainid: codeForBuy,
        //picture: req.body.picture,
        //reason:  req.body.reason,
			  //group: status,
			  //department: department,
			},

			function (data, status) {
			  window.location.href = "/admin";
			  
			}
		  );
		 } 
	  } 
  }

  function editData(i){
			console.log("addzsadsadzzz");
			$.post("/get/dataForSearchTableMainIdAdmin2",{_ID: getValueLocalStorage}, function (data, status) {
						
				//console.log(data[i]._id);
        getDataId = data[i]._id;
        console.log("DATAID"+getDataId);
				//console.log("add");
				document.getElementById("Modal-c").innerHTML="";
				$("#Modal-c").append(
          "ชื่อวัสดุ <br>"+
					"<input id='itemnew'type='text' type='text'value='"+ data[i].item +"'>" +'<br>'+ 
          '<br>'+
          "Part Number <br>"+
					"<input id='partnumbernew'type='text' type='text'value='"+ data[i].partnumber +"'>" +'<br>'+ 
          '<br>'+
          "ราคา(เสนอ) <br>"+
					"<input id='pricenew'type='text' type='text'value='"+ data[i].price +"'>" +'<br>'+ 
          '<br>'+
          "จำนวน(เสนอ) <br>"+
					"<input id='amountnew'type='text' type='text'value='"+ data[i].amount +"'>" +'<br>'+ 
          '<br>'+
          "ราคา(แก้ไข) <br>"+
					"<input id='pricenewedit'type='text' type='text'value='"+ data[i].priceadmin +"'>" +'<br>'+ 
          '<br>'+
          "จำนวน(แก้ไข) <br>"+
					"<input id='amountnewedit'type='text' type='text'value='"+ data[i].amountadmin +"'>" +'<br>'+ 
          '<br>'+
          "ราคารวม(เสนอ) <br>"+
					"<input id='sumpricenew'type='text' type='text'value='"+ data[i].sumprice +"'>" +'<br>'+ 
          '<br>'+
          "ราคารวม(แก้ไข) <br>"+
					"<input id='sumpricenewedit'type='text' type='text'value='"+ data[i].sumpriceadmin +"'>" +'<br>'+ 
          '<br>'+
          // "ราคารวม(แก้ไข) <br>"+
					// "<input id='sumpricenewedit'type='text' type='text'value='"+ data[i].sumpriceadmin +"'>" +'<br>'+ 
          // '<br>'+
          "ผู้รับผิดชอบ <br>"+
					"<input id='responsiblepersonnew'type='text' type='text'value='"+ data[i].responsibleperson +"'>" +'<br>'+ 
          '<br>'+
          "สถานะ <br>"+
					"<input id='statusznew'type='text' type='text'value='"+ data[i].statusz +"'>" +'<br>'+ 
          '<br>'+
          "รูป <br>"+
					"<input type='file' id='img' name='img' accept='image/*'>"

				);
						
						
			});
    }


    function addEdit(){
			console.log('DDazzzn');
    //var shopnew = $("#shopnew").val();
    var itemnew = $("#itemnew").val();
    var partnumbernew = $("#partnumbernew").val();
    var pricenew = $("#pricenew").val();
    var amountnew = $("#amountnew").val();
    var pricenewedit = $("#pricenewedit").val();
    var amountnewedit = $("#amountnewedit").val();
    var sumpricenew = $("#sumpricenew").val();
    var sumpricenewedit = $("#sumpricenewedit").val();
    var responsiblepersonnew = $("#responsiblepersonnew").val();
    var statusznew = $("#statusznew").val();
   //var statusnew = $("#statusnew").val();
    //var statusnew = $("#statusnew").val();


  console.log(itemnew,partnumbernew,pricenew,
  amountnew,pricenewedit,amountnewedit,sumpricenew,sumpricenewedit,responsiblepersonnew,statusznew
  );
  //console.log(getDataId);

    $.post("/save/editdataadmin",{  
							              'ServergetDataId':getDataId,	
							              //'shopnew':shopnew,
                            'itemnew':itemnew,
                            'partnumbernew':partnumbernew,
                            'pricenew':pricenew,
                            'amountnew':amountnew,
                             'pricenewedit':pricenewedit,
                            'amountnewedit':amountnewedit,
                            'sumpricenew':sumpricenew,
                            'sumpricenewedit':sumpricenewedit,		
							              'responsiblepersonnew':responsiblepersonnew,
                            'statusznew':statusznew,
                            //amountnew:amountnew,
                            // nameordernew:nameordernew,
                            // statusnew:statusnew,
                            // department: department
                            
                        },function(data, status){
                          console.log(data);
                           window.location.href = "/admin";
							// showData();
        });
    }


    function DeleteDataAdmin(obj_id) {
	let dropRoomId = obj_id.toString();
	console.log("delete--->>>    " + obj_id);
    $.post("/drop/dataAdmin", { dropRoomId: dropRoomId }, function (data, status) {
      window.location.href = "/admin";
      console.log(obj_id);
	});
  }	

  function addShop() {
		console.log("danxxx");
	  {
		if (confirm("ต้องการเพิ่มผู้ใช้หรือไม่")) {
		  var shop = $("#nameshop").val();
		  var type = $("#typeshoppp").val();
		  var tax = $("#taxshop").val();
      console.log(shop,type,tax);
		  //var group = $("#group").val();
		  //var department = $("#department").val();
      if(tax="7"){
        tax=1.07;
      }
		  $.post(
			"/api/addshop",
			{
			  shop: shop,
			  type: type,
			  tax: tax,
        //picture: req.body.picture,
        //reason:  req.body.reason,
			  //group: status,
			  //department: department,
			},

			function (data, status) {
        console.log(data);
			  window.location.href = "/admin";
			  
			}
		  );
		 } 
	  } 
  }

  var ShowShopName = {};

  $(document).ready(function(){
      $.post('/get/shop', function(data, status)
      {
        ShopName = data;
          for(let i=0; i<ShopName.length; i++)
          {
              // console.log([data[i]]); 
              let objId = ShopName[i]._id;

              ShowShopName[objId] = ShopName[i].nameOfShop;

              //let nameCategory = categoryName[i].equip_category;

          }
      });
  });
  

  function Editshop(){

    $.post("/get/shop",function (data, status) {

      
    //document.getElementById("room-name").innerHTML="";
      console.log('Daaawwwwdqwdqwdqwd');
      //var sum = 0 ;
		//document.getElementById("room-name").innerHTML="";
      for (let i = 0; i < data.length; i++) {
       // data[i].sumpriceadmin = 0;
       
         //data[i].sumpriceadmin = data[i].priceadmin * data[i].amountadmin;
        //  data[i].sumprice = data[i].price * data[i].amount;
         //data[i].sumprice = "";
        // data[i].sumpriceadmin = "";
      //   sum += parseInt(data[i].sumpriceadmin);
       

      //  console.log("Sum = "+ sum);   
		  //console.log(data[i]._id);
		  str = data[i]._id.replace(/\s/g, '');
		  console.log(str);
        roomId = data;
		// let rstripId = data[i]._id.rs
        //$("#room-name-value").val(data[0].room);
        $("#modal-D").append(
          "ชื่อวัสดุ <br>"+
					"<input id='itemnew'type='text' type='text'value='"+ data[i].nameOfShop +"'>" +'<br>'+ 
          '<br>'+
          "Part Number <br>"+
					"<input id='partnumbernew'type='text' type='text'value='"+ data[i].typeOfShop +"'>" +'<br>'+ 
          '<br>'+
          "ราคา(เสนอ) <br>"+
					"<input id='pricenew'type='text' type='text'value='"+ data[i].tax +"'>" +'<br>'+ 
          '<br>'
			// "<td>" +
			// <a data-toggle="modal" data-target="#Modalzz">แก้ไข</a> +
			// "</td>" +
			//  "<td><a data-toggle='modal' data-target='#myModalForEditDataAdmin' class='btn btn-info'  onclick='editData("+i+")' >แก้ไข</a>" +
			// 	//"<td><a data-toggle='modal' data-target='#Modalzz' data-target='#exampleModal02' onclick='save()' >แก้ไข</a>" +
      //       "<div class='modal fade' id='exampleModal02' tabindex='-1' role='dialog' aria-labelledby='exampleModal02Label' aria-hidden='true' data-backdrop='static' data-keyboard='false'>" +
      //       "<div class='modal-dialog modal-dialog-centered'>" +
      //       "<div class='modal-content'>" +
      //       "<div class='modal-header'>" +
      //       "<h5 class='modal-title'  id='exampleModal02Label'>แก้ไข</h5>" +
      //       "<button type='button' class='close' data-dismiss='modal' aria-label='Close'>" +
      //       "<span aria-hidden='true'>&times;</span>" +
      //       "</button>" +
      //       "</div>" +
      //       "<div class='modal-footer'>" +
      //       "<button type='button' class='btn btn-secondary' data-dismiss='modal'>ยกเลิก</button>" +
      //       "</div>" +
      //       "</div></td>" +
      //       "<td><button href='#' class='btn btn-danger' onclick=DeleteDataAdmin('"+str.toString()+"') >ลบ</button></td>" +
		
			

        );  
      }
      
    }); 

  }

    
    var getDataId = "";

    var getValueLocalStorage = localStorage.getItem('thisIsParameterName');

    var getValueLocalStorageNameOrder = localStorage.getItem("thisIsParameterNameForNameOrder");

    var getValueLocalStorageAmount = localStorage.getItem("thisIsParameterNameForAmount");

</script>